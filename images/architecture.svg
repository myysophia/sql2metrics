<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 550" role="img" aria-labelledby="sql2metrics-title">
  <title id="sql2metrics-title">SQL2Metrics Architecture - Database Query to Prometheus Metrics</title>

  <!-- CSS Animations -->
  <style>
    .flow-line {
      stroke-dasharray: 8,4;
      animation: flow 1.5s linear infinite;
    }

    @keyframes flow {
      to { stroke-dashoffset: -24; }
    }

    .pulse-center {
      transform-origin: 450px 275px;
      animation: pulse 2.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.9; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.05); }
    }

    .rotate-slow {
      transform-origin: 450px 275px;
      animation: rotate-slow 20s linear infinite;
    }

    @keyframes rotate-slow {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .fade-in {
      animation: fade-in 2s ease-out;
    }

    @keyframes fade-in {
      from { opacity: 0; transform: translateY(15px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .glow-blue {
      filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.6));
      animation: glow-blue-pulse 2.5s ease-in-out infinite;
    }

    @keyframes glow-blue-pulse {
      0%, 100% { filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.6)); }
      50% { filter: drop-shadow(0 0 16px rgba(59, 130, 246, 0.9)); }
    }

    .glow-green {
      filter: drop-shadow(0 0 6px rgba(34, 197, 94, 0.7));
    }

    .glow-orange {
      filter: drop-shadow(0 0 6px rgba(249, 115, 22, 0.7));
    }

    .data-flow {
      stroke-dasharray: 10,5;
      animation: data-flow 2s linear infinite;
    }

    @keyframes data-flow {
      to { stroke-dashoffset: -30; }
    }

    .ai-mesh-border {
      stroke-dasharray: 6, 4;
      animation: ai-flow 3s linear infinite;
    }

    @keyframes ai-flow {
      to { stroke-dashoffset: -20; }
    }
  </style>

  <!-- Background -->
  <defs>
    <linearGradient id="bg-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f8fafc"/>
      <stop offset="100%" style="stop-color:#f1f5f9"/>
    </linearGradient>
    <linearGradient id="ai-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#d8b4fe"/>
      <stop offset="100%" style="stop-color:#f3e8ff"/>
    </linearGradient>
    <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#8b5cf6" />
    </marker>
  </defs>
  <rect width="900" height="550" fill="url(#bg-gradient)" stroke="#cbd5e1" stroke-width="2" rx="12"/>

  <!-- Title -->
  <text x="450" y="40" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="24" font-weight="700" fill="#1e293b">
    SQL2Metrics Architecture
  </text>
  <text x="450" y="62" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="14" fill="#64748b">
    Database Query â†’ Prometheus Metrics Pipeline
  </text>

  <!-- Left: Data Sources -->
  <g class="fade-in">
    <text x="120" y="110" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="600" fill="#475569">Data Sources</text>

    <!-- MySQL -->
    <rect x="40" y="125" width="160" height="45" rx="10" fill="#3b82f6" fill-opacity="0.15" stroke="#3b82f6" stroke-width="2"/>
    <text x="120" y="153" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600" fill="#2563eb">ğŸ—„ï¸ MySQL</text>

    <!-- Redis -->
    <rect x="40" y="180" width="160" height="45" rx="10" fill="#ef4444" fill-opacity="0.15" stroke="#ef4444" stroke-width="2"/>
    <text x="120" y="208" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600" fill="#dc2626">ğŸ“¦ Redis</text>

    <!-- IoTDB -->
    <rect x="40" y="235" width="160" height="45" rx="10" fill="#22c55e" fill-opacity="0.15" stroke="#22c55e" stroke-width="2"/>
    <text x="120" y="263" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600" fill="#16a34a">ğŸ“Š IoTDB</text>

    <!-- RestAPI -->
    <rect x="40" y="290" width="160" height="45" rx="10" fill="#8b5cf6" fill-opacity="0.15" stroke="#8b5cf6" stroke-width="2"/>
    <text x="120" y="318" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600" fill="#7c3aed">ğŸŒ RestAPI</text>

    <!-- Connection Pool Label -->
    <text x="120" y="360" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#94a3b8">Connection Pool</text>
  </g>

  <!-- Data Flow Lines: Sources to Core -->
  <g>
    <path d="M200 148 Q280 148 320 230" fill="none" stroke="#3b82f6" stroke-width="2" class="data-flow"/>
    <path d="M200 203 Q280 203 320 250" fill="none" stroke="#ef4444" stroke-width="2" class="data-flow"/>
    <path d="M200 258 Q280 258 320 270" fill="none" stroke="#22c55e" stroke-width="2" class="data-flow"/>
    <path d="M200 313 Q280 313 320 290" fill="none" stroke="#8b5cf6" stroke-width="2" class="data-flow"/>
  </g>

  <!-- Center: SQL2Metrics Core -->
  <g class="pulse-center">
    <!-- Outer ring -->
    <circle cx="450" cy="260" r="110" fill="#8b5cf6" fill-opacity="0.08" stroke="#8b5cf6" stroke-width="2" class="glow-blue"/>
    <circle cx="450" cy="260" r="80" fill="none" stroke="#8b5cf6" stroke-width="1.5" stroke-dasharray="12,6" class="rotate-slow"/>

    <!-- Core text (no box) -->
    <text x="450" y="245" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="18" font-weight="700" fill="#7c3aed">SQL2Metrics</text>
    <text x="450" y="265" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="12" fill="#6b7280">Go Collector Engine</text>
    
    <!-- Features -->
    <text x="450" y="285" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="10" fill="#8b5cf6">Concurrent â€¢ Hot Reload â€¢ YAML</text>
  </g>

  <!-- AI Copilot Mesh (Top Right) -->
  <g class="fade-in">
    <!-- Mesh Background: Dashed Box -->
    <rect x="610" y="30" width="230" height="120" rx="15" fill="none" stroke="#8b5cf6" stroke-width="1.5" class="ai-mesh-border"/>
    
    <text x="725" y="55" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="700" fill="#7c3aed">ğŸ¤– AI Copilot Mesh</text>
    
    <!-- AI Features -->
    <rect x="620" y="70" width="100" height="30" rx="6" fill="#f3e8ff" stroke="#d8b4fe" stroke-width="1"/>
    <text x="670" y="90" text-anchor="middle" font-size="10" fill="#9333ea">Text-to-SQL</text>
    
    <rect x="730" y="70" width="100" height="30" rx="6" fill="#f3e8ff" stroke="#d8b4fe" stroke-width="1"/>
    <text x="780" y="90" text-anchor="middle" font-size="10" fill="#9333ea">Smart Diagnose</text>
    
    <rect x="665" y="110" width="120" height="30" rx="6" fill="#f3e8ff" stroke="#d8b4fe" stroke-width="1"/>
    <text x="725" y="130" text-anchor="middle" font-size="10" fill="#9333ea">Config Assistant</text>

    <!-- Connection Lines to Core only -->
    <path d="M725 150 Q725 200 550 240" fill="none" stroke="#8b5cf6" stroke-width="1.5" stroke-dasharray="3,3" marker-end="url(#arrow)"/>
  </g>

  <!-- Right: Prometheus Output -->
  <g class="fade-in">
    <text x="780" y="215" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="600" fill="#475569">Metrics Output</text>

    <!-- Prometheus Endpoint -->
    <rect x="700" y="235" width="160" height="70" rx="12" fill="#f97316" fill-opacity="0.15" stroke="#f97316" stroke-width="2" class="glow-orange"/>
    <text x="780" y="270" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600" fill="#ea580c">ğŸ”¥ Prometheus</text>
    <text x="780" y="290" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="11" fill="#9a3412">/metrics endpoint</text>

    <!-- Grafana -->
    <rect x="700" y="325" width="160" height="50" rx="10" fill="#06b6d4" fill-opacity="0.15" stroke="#06b6d4" stroke-width="2"/>
    <text x="780" y="355" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600" fill="#0891b2">ğŸ“ˆ Grafana</text>

    <!-- Alerting -->
    <rect x="700" y="395" width="160" height="50" rx="10" fill="#eab308" fill-opacity="0.15" stroke="#eab308" stroke-width="2"/>
    <text x="780" y="425" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600" fill="#ca8a04">ğŸš¨ Alerting</text>
  </g>

  <!-- Data Flow Lines: Core to Output -->
  <g>
    <path d="M560 260 Q620 260 700 270" fill="none" stroke="#f97316" stroke-width="2" class="data-flow"/>
    <path d="M560 260 Q620 290 700 350" fill="none" stroke="#06b6d4" stroke-width="2" class="data-flow"/>
    <path d="M560 260 Q620 340 700 420" fill="none" stroke="#eab308" stroke-width="2" class="data-flow"/>
  </g>

  <!-- Bottom: Web UI & Config -->
  <g class="fade-in">
    <text x="400" y="430" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="600" fill="#475569">Management Layer</text>

    <!-- Web UI -->
    <rect x="130" y="450" width="140" height="55" rx="10" fill="#ec4899" fill-opacity="0.15" stroke="#ec4899" stroke-width="2"/>
    <text x="200" y="478" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600" fill="#db2777">ğŸŒ Web UI</text>
    <text x="200" y="493" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="10" fill="#be185d">React + Shadcn</text>

    <!-- YAML Config -->
    <rect x="290" y="450" width="140" height="55" rx="10" fill="#10b981" fill-opacity="0.15" stroke="#10b981" stroke-width="2"/>
    <text x="360" y="478" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600" fill="#059669">ğŸ“ YAML Config</text>
    <text x="360" y="493" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="10" fill="#047857">Hot Reload</text>

    <!-- REST API -->
    <rect x="450" y="450" width="140" height="55" rx="10" fill="#6366f1" fill-opacity="0.15" stroke="#6366f1" stroke-width="2"/>
    <text x="520" y="478" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600" fill="#4f46e5">âš¡ REST API</text>
    <text x="520" y="493" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="10" fill="#4338ca">Config Management</text>

    <!-- MCP Server (New) -->
    <rect x="610" y="450" width="140" height="55" rx="10" fill="none" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="680" y="478" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="600" fill="#7c3aed">ğŸ¤– MCP Server</text>
    <text x="680" y="493" text-anchor="middle" font-family="Inter, system-ui, sans-serif" font-size="10" fill="#6d28d9">Agent Interface</text>
  </g>

  <!-- Vertical Flow Lines: Management to Core -->
  <g>
    <path d="M200 450 Q200 400 380 330" fill="none" stroke="#ec4899" stroke-width="1.5" stroke-dasharray="5,3"/>
    <path d="M360 450 Q360 400 430 330" fill="none" stroke="#10b981" stroke-width="1.5" stroke-dasharray="5,3"/>
    <path d="M520 450 Q520 400 480 330" fill="none" stroke="#6366f1" stroke-width="1.5" stroke-dasharray="5,3"/>
    <path d="M680 450 Q680 400 520 330" fill="none" stroke="#8b5cf6" stroke-width="1.5" stroke-dasharray="5,3"/>
  </g>

</svg>
